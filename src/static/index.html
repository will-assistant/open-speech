<!doctype html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Open Speech</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/static/app.css">
</head>
<body>
  <main class="container">
    <header class="header">
      <div class="header-row">
        <h1>Open Speech <span class="version" id="app-version"></span></h1>
        <button id="theme-toggle" class="btn btn-ghost btn-sm" type="button" aria-label="Toggle theme">ðŸŒ™</button>
      </div>
      <div class="tabs" role="tablist" aria-label="Main tabs">
        <button class="tab active" data-tab="transcribe" role="tab" aria-selected="true">Transcribe</button>
        <button class="tab" data-tab="speak" role="tab" aria-selected="false">Speak</button>
        <button class="tab" data-tab="models" role="tab" aria-selected="false">Models</button>
        <button class="tab" data-tab="history" role="tab" aria-selected="false">History</button>
        <button class="tab" data-tab="studio" role="tab" aria-selected="false">Studio</button>
        <button class="tab" data-tab="settings" role="tab" aria-selected="false">Settings</button>
      </div>
    </header>
    <section id="panel-transcribe" class="panel active" role="tabpanel">
      <article class="card">
        <h2>Speech to Text</h2>
        <div class="field">
          <label for="stt-model">Model</label>
          <select id="stt-model"></select>
        </div>
        <label id="stt-dropzone" class="dropzone" for="stt-file">
          <input id="stt-file" type="file" accept="audio/*" hidden>
          <span>ðŸŽµ drag &amp; drop here</span>
          <small>Drop audio file or click to upload</small>
        </label>
        <div class="form-row">
          <button id="mic-btn" class="btn" type="button">ðŸŽ™ Start Mic</button>
          <div class="vad-wrap"><span id="vad-dot" class="status-dot"></span><span id="vad-text">Silence</span></div>
          <div class="field-inline">
            <label for="stt-format">Format</label>
            <select id="stt-format">
              <option value="text">Text</option>
              <option value="json">JSON</option>
              <option value="verbose_json">Verbose JSON</option>
            </select>
          </div>
        </div>
        <div class="result">
          <h3>Result</h3>
          <p><strong>Partial:</strong> <span id="stt-partial">â€”</span></p>
          <p><strong>Final:</strong> <span id="stt-final">â€”</span>
            <button id="copy-transcript" class="btn btn-ghost btn-sm" type="button">ðŸ“‹ Copy</button>
          </p>
          <p class="result-meta">Duration: <span id="stt-duration">â€”</span> Â· Processing: <span id="stt-processing">â€”</span>
            <button id="save-transcript" class="btn btn-ghost btn-sm" type="button">â¬‡ Save</button>
          </p>
        </div>
      </article>
      <details>
        <summary>Recent Transcriptions</summary>
        <div id="stt-history"></div>
      </details>
    </section>
    <section id="panel-speak" class="panel" role="tabpanel" hidden>
      <article class="card">
        <h2>Text to Speech</h2>
        <div class="form-row">
          <button id="tts-save-profile" class="btn btn-ghost btn-sm" type="button">Save as Profile</button>
        </div>
        <textarea id="tts-input" rows="6" maxlength="5000" placeholder="Enter text to synthesizeâ€¦"></textarea>
        <div class="form-row space-between">
          <small id="tts-counter">0 / 5,000</small>
          <label class="btn btn-ghost btn-sm" for="tts-upload">ðŸ“„ Upload .txt</label>
          <input id="tts-upload" type="file" accept=".txt,text/plain" hidden>
        </div>
        <div class="form-row two-col">
          <div class="field">
            <label for="tts-provider">Provider</label>
            <select id="tts-provider"></select>
          </div>
          <div class="field">
            <label for="tts-model">Model <span id="tts-model-status" class="state-badge"></span></label>
            <select id="tts-model"></select>
          </div>
        </div>
        <div class="form-row two-col">
          <div class="field">
            <label for="tts-voice">Voice</label>
            <select id="tts-voice"></select>
          </div>
          <div class="field">
            <label for="tts-preset">Preset</label>
            <select id="tts-preset">
              <option value="">â€” Custom â€”</option>
            </select>
          </div>
        </div>
        <div class="form-row">
          <label for="tts-speed">Speed</label>
          <input id="tts-speed" type="range" min="0.5" max="2" step="0.1" value="1">
          <span id="tts-speed-value">1.0x</span>
          <div class="field-inline">
            <label for="tts-format">Format</label>
            <select id="tts-format">
              <option value="mp3">MP3</option>
              <option value="wav">WAV</option>
              <option value="pcm">PCM</option>
            </select>
          </div>
        </div>
        <details id="effects-panel">
          <summary>ðŸŽ› Voice Effects</summary>
          <div class="effects-grid">
            <label class="effect-toggle"><input type="checkbox" data-effect="normalize"> Normalize</label>
            <label class="effect-toggle"><input type="checkbox" data-effect="podcast_eq"> Podcast EQ</label>
            <label class="effect-toggle"><input type="checkbox" data-effect="reverb"> Reverb
              <select data-effect-param="reverb-room"><option value="small">Small</option><option value="medium">Medium</option><option value="large">Large</option></select>
            </label>
            <label class="effect-toggle"><input type="checkbox" data-effect="pitch"> Pitch
              <input type="number" data-effect-param="pitch-semitones" min="-12" max="12" value="0" style="width:50px"> st
            </label>
            <label class="effect-toggle"><input type="checkbox" data-effect="robot"> Robot</label>
          </div>
        </details>
        <div class="form-row">
          <button id="tts-generate" class="btn" type="button">â–¶ Generate</button>
          <label id="tts-stream-group" class="stream-toggle" hidden><input id="tts-stream" type="checkbox"> Stream</label>
          <button id="tts-download" class="btn btn-ghost" type="button" disabled>â¬‡ Download</button>
        </div>
        <details id="tts-advanced" hidden>
          <summary>Advanced</summary>
          <div id="tts-advanced-content"></div>
        </details>
      </article>
      <div id="audio-player" class="audio-player" hidden>
        <audio id="tts-audio" controls></audio>
      </div>
      <details>
        <summary>Recent Generations</summary>
        <div id="tts-history"></div>
      </details>
    </section>
    <section id="panel-models" class="panel" role="tabpanel" hidden>
      <article class="card">
        <div class="card-head">
          <h2>Loaded Models</h2>
          <button id="models-refresh" class="btn btn-ghost btn-sm" type="button">ðŸ”„ Refresh</button>
        </div>
        <p id="loaded-count">0 models loaded</p>
        <table class="models-table">
          <thead><tr><th>Model</th><th>Type</th><th>Device</th><th>Action</th></tr></thead>
          <tbody id="loaded-models-body"></tbody>
        </table>
      </article>
      <p class="legend">Note: Kokoro is pre-baked in the default GPU image. Other providers install quickly, then cache model weights on first <strong>Load</strong> (or with <strong>Cache</strong>).</p>
      <div class="models-two-col">
        <article class="card models-kind-card">
          <h2>STT â€” Speech to Text</h2>
          <div id="stt-models-list" class="models-list"></div>
        </article>
        <article class="card models-kind-card">
          <h2>TTS â€” Text to Speech</h2>
          <div id="tts-models-list" class="models-list"></div>
        </article>
      </div>
      <article class="card">
        <h2>Providers</h2>
        <div class="providers-group">
          <h3>Speech-to-Text Providers</h3>
          <div id="stt-providers-list" class="providers-list"></div>
        </div>
        <div class="providers-group">
          <h3>Text-to-Speech Providers</h3>
          <div id="tts-providers-list" class="providers-list"></div>
        </div>
      </article>
    </section>
    <section id="panel-history" class="panel" role="tabpanel" hidden>
      <article class="card">
        <h2>History</h2>
        <div class="form-row two-col">
          <div class="field"><label for="history-type">Type</label><select id="history-type"><option value="">All</option><option value="tts">TTS</option><option value="stt">STT</option></select></div>
          <div class="field"><label for="history-search">Search</label><input id="history-search" type="text" placeholder="Filter text/file"></div>
        </div>
        <table class="models-table"><thead><tr><th>Type</th><th>Date</th><th>Text/File</th><th>Model</th><th>Voice</th><th>Actions</th></tr></thead><tbody id="history-body"></tbody></table>
        <div class="form-row"><button id="history-prev" class="btn btn-ghost btn-sm" type="button">Prev</button><span id="history-count">0</span><button id="history-next" class="btn btn-ghost btn-sm" type="button">Next</button><button id="history-clear" class="btn btn-danger btn-sm" type="button">Clear All History</button></div>
      </article>
    </section>
    <section id="panel-studio" class="panel" role="tabpanel" hidden>
      <article class="card">
        <h2>Conversations</h2>
        <div class="form-row">
          <button id="studio-new-conversation" class="btn btn-sm" type="button">New Conversation</button>
          <div class="field-inline"><label for="studio-name">Name</label><input id="studio-name" type="text" placeholder="Conversation name"></div>
        </div>
        <div class="card">
          <div class="form-row two-col">
            <div class="field"><label for="studio-speaker">Speaker</label><input id="studio-speaker" type="text" placeholder="Alice"></div>
            <div class="field"><label for="studio-profile">Profile</label><select id="studio-profile"><option value="">â€” None â€”</option></select></div>
          </div>
          <div class="field"><label for="studio-text">Text</label><input id="studio-text" type="text" placeholder="Turn text"></div>
          <div class="form-row"><button id="studio-add-turn" class="btn btn-sm" type="button">Add Turn</button></div>
        </div>
        <div id="studio-turns"></div>
        <div class="form-row">
          <button id="studio-render" class="btn btn-sm" type="button">â–¶ Render All</button>
          <button id="studio-download-wav" class="btn btn-ghost btn-sm" type="button" disabled>â¬‡ Download WAV</button>
          <button id="studio-download-mp3" class="btn btn-ghost btn-sm" type="button" disabled>â¬‡ Download MP3</button>
        </div>
        <p id="studio-status" class="legend">Render status: Ready</p>
        <div class="form-row">
          <label for="studio-past">Past Conversations</label>
          <select id="studio-past"></select>
          <button id="studio-load" class="btn btn-ghost btn-sm" type="button">Load</button>
          <button id="studio-delete" class="btn btn-danger btn-sm" type="button">Delete</button>
        </div>
      </article>

      <article class="card" id="composer-section">
        <h2>ðŸŽš Multi-Track Composer</h2>
        <div id="composer-tracks"></div>
        <div class="form-row">
          <button id="composer-add-track" class="btn btn-ghost btn-sm" type="button">+ Add Track</button>
        </div>
        <div class="form-row">
          <div class="field-inline">
            <label for="composer-format">Format</label>
            <select id="composer-format">
              <option value="wav">WAV</option>
              <option value="mp3">MP3</option>
            </select>
          </div>
          <button id="composer-render-btn" class="btn" type="button">â–¶ Render Mix</button>
          <span id="composer-status" class="row-status"></span>
        </div>
        <div id="composer-result" style="display:none">
          <audio id="composer-audio" controls></audio>
          <button id="composer-download" class="btn btn-ghost btn-sm" type="button">â¬‡ Download</button>
        </div>
        <details style="margin-top:16px">
          <summary style="cursor:pointer;color:var(--text2);font-size:.85rem">Past renders</summary>
          <div id="composer-history"></div>
        </details>
      </article>
    </section>
    <section id="panel-settings" class="panel" role="tabpanel" hidden>
      <article class="card">
        <h2>Voice Profiles</h2>
        <div class="form-row"><button id="profile-new" class="btn btn-sm" type="button">New Profile</button></div>
        <table class="models-table"><thead><tr><th>Name</th><th>Backend</th><th>Model</th><th>Voice</th><th>Speed</th><th>Default</th><th>Actions</th></tr></thead><tbody id="profiles-body"></tbody></table>
      </article>
      <article class="card">
        <h2>History Settings</h2>
        <div class="field"><label><input id="history-enabled" type="checkbox" checked> Enable history</label></div>
        <div class="field"><label for="history-max-entries">Max entries</label><input id="history-max-entries" type="number" value="1000"></div>
        <div class="field"><label><input id="history-retain-audio" type="checkbox" checked> Retain audio files</label></div>
        <div class="form-row"><button id="settings-clear-history" class="btn btn-danger btn-sm" type="button">Clear All</button></div>
      </article>
      <dialog id="profile-dialog">
        <form method="dialog" id="profile-form">
          <h3>Profile</h3>
          <div class="field"><label>Name</label><input id="profile-name" required></div>
          <menu class="form-row"><button value="cancel" class="btn btn-ghost btn-sm">Cancel</button><button id="profile-save" value="default" class="btn btn-sm">Save</button></menu>
        </form>
      </dialog>
    </section>
  </main>
  <div id="toast-root" class="toast-root" aria-live="polite"></div>
  <script src="/static/app.js" defer></script>
</body>
</html>
